!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("underscore"),require("jquery"),require("backbone"),require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["underscore","jquery","backbone","react","react-dom"],e):"object"==typeof exports?exports.Tilegrid=e(require("underscore"),require("jquery"),require("backbone"),require("react"),require("react-dom")):t.Tilegrid=e(t._,t.jQuery,t.Backbone,t.React,t.ReactDOM)}(this,function(t,e,i,o,n){return function(t){function e(o){if(i[o])return i[o].exports;var n=i[o]={exports:{},id:o,loaded:!1};return t[o].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var i={};return e.m=t,e.c=i,e.p="dist/",e(0)}([function(t,exports,e){t.exports=e(1)},function(t,exports,e){"use strict";var i=e(2),o=e(6),n=e(15);null!=window&&(window.jQueryTilegrid=i,window.ReactTilegrid=o,window.MultiSelect=n),t.exports={jQueryTilegrid:i,ReactTilegrid:o,MultiSelect:n}},function(t,exports,e){var $,i,o,n,s,l=function(t,e){return function(){return t.apply(e,arguments)}};n=e(3),$=s=e(4),i=e(5),t.exports=o=function(){function t(t,e,o,s){if(this.selector=t,this.data=e,null==s&&(s={}),this._renderDerenderedPlaceholder=l(this._renderDerenderedPlaceholder,this),this._derenderTile=l(this._derenderTile,this),this._derenderOutsideTiles=l(this._derenderOutsideTiles,this),this._onTileGridClick=l(this._onTileGridClick,this),this._onResize=l(this._onResize,this),this._onScroll=l(this._onScroll,this),this._onModelRemove=l(this._onModelRemove,this),this._onCollectionAdd=l(this._onCollectionAdd,this),this._onCollectionReset=l(this._onCollectionReset,this),this._loadingInWindow=l(this._loadingInWindow,this),this._endOfData=l(this._endOfData,this),this.tileFor=l(this.tileFor,this),this.findTileAt=l(this.findTileAt,this),this.tileAt=l(this.tileAt,this),this._getTileTemplate=l(this._getTileTemplate,this),this._renderTileTemplate=l(this._renderTileTemplate,this),this.renderTile=l(this.renderTile,this),this.renderTileAt=l(this.renderTileAt,this),this._cloneTileTemplate=l(this._cloneTileTemplate,this),this.appendTile=l(this.appendTile,this),this.getTotalItems=l(this.getTotalItems,this),this._onEnsureComplete=l(this._onEnsureComplete,this),this._renderNextPage=l(this._renderNextPage,this),this.renderAllTiles=l(this.renderAllTiles,this),this._isInViewPort=l(this._isInViewPort,this),this._findTileInViewport=l(this._findTileInViewport,this),this._getTileDims=l(this._getTileDims,this),this._getGridScrollDims=l(this._getGridScrollDims,this),this.getViewingStats=l(this.getViewingStats,this),this.getItemData=l(this.getItemData,this),this._onEnsureRowsComplete=l(this._onEnsureRowsComplete,this),this._ensureViewport=l(this._ensureViewport,this),this._renderViewport=l(this._renderViewport,this),this._renderGrid=l(this._renderGrid,this),this._initializeCollection=l(this._initializeCollection,this),this.updateCollectionViewStats=l(this.updateCollectionViewStats,this),this.getRenderedTiles=l(this.getRenderedTiles,this),this.setActiveTileFor=l(this.setActiveTileFor,this),this.setActiveTile=l(this.setActiveTile,this),this.getActiveTile=l(this.getActiveTile,this),this.setTileTemplate=l(this.setTileTemplate,this),this.focus=l(this.focus,this),this.render=l(this.render,this),this.refresh=l(this.refresh,this),this.reset=l(this.reset,this),this.destroy=l(this.destroy,this),this.initialize=l(this.initialize,this),this.options=n.defaults(s,{pageSize:50,preloadCushion:400,ignoreViewport:!1,hideFunction:null,tileWrapperClassNames:""}),this.setTileTemplate(o),!(n.isArray(this.data)||this.data instanceof i.Collection))throw"Tilegrid expects @data constructor arg to be either and array or a Collection";this.debouncedRefresh=n.debounce(this.refresh,0),this.debouncedRender=n.debounce(this.render,0),this.initialize()}return t.prototype.$tilegridTemplate=$('<div class="tilegrid">\n    <div class="tilegrid-loading">\n        <div class="placeholder fade in">\n            ... more to come ...\n            &nbsp;\n        </div>\n    </div>\n</div>'),t.prototype.initialize=function(){var t,e;if(this.$element=$(this.selector),n.extend(this,i.Events),!((null!=(t=this.$element)?t.length:void 0)>0))throw"Dev: error: "+this.$element.selector+" not found in DOM";return this._initializeCollection(),this._renderGrid(),this.reset(),this.render(),null!=(e=this.$tilegrid)?e.data("tilegrid",this):void 0},t.prototype.destroy=function(){var t;return null!=(t=this.$tilegrid)?t.data("tilegrid",null):void 0},t.prototype.reset=function(t){var e,i,o,s,l;if(null==t&&(t={}),t=n.defaults(t,{soft:!1}),this._$tilesByModelId={},t.soft)for(o=this.$element.find(".tile"),e=0,i=o.length;i>e;e++)s=o[e],this._derenderTile($(s));else this.lastAppendedIndex=-1,this.$element.find(".tile").remove();return l=this.getTotalItems(),l>0&&l>this.lastAppendedIndex+1&&this.$loadingIndicator.show(),this},t.prototype.refresh=function(){return this.reset({soft:!0}),this._ensureViewport()},t.prototype.render=function(){return this._renderViewport(),this},t.prototype.focus=function(){var t;return null!=this.selections?"function"==typeof(t=this.selections).focus?t.focus():void 0:n.delay(function(t){return function(){return t.$tilegrid.focus()}}(this),100)},t.prototype.setTileTemplate=function(t){if(this.tileTemplate=t,this.$tileTemplate=$(this.tileTemplate),this.$tileTemplate.length<=0)throw"dev error: Invalid template in TileGrid construction:<br>"+tileTemplate},t.prototype.getActiveTile=function(){var t;return null!=(t=this.selections)&&"function"==typeof t.getActiveTile?t.getActiveTile():void 0},t.prototype.setActiveTile=function(t){var e;return null!=(e=this.selections)&&"function"==typeof e.setActiveTile?e.setActiveTile(t):void 0},t.prototype.setActiveTileFor=function(t){var e,i,o;if(null==t)return null;if(e=this.tileFor(t),!((null!=e?e.length:void 0)>0))return null;if(i=e.data("index"),null==i)throw"dev: unexpected: tile for model "+t.id+" has no index attribute";return null!=(o=this.selections)&&o.setActiveTile(i),e},t.prototype.getRenderedTiles=function(){return n.values(this._$tilesByModelId)},t.prototype.updateCollectionViewStats=function(t){var e,i;if(null!=this.collection)return i=this.getTotalItems(),0>=i&&n.extend(t,{topDisplayIndex:0,bottomDisplayIndex:0}),this.collection.hasStats?this.collection.updateStats(t):(this.collection.topDisplayIndex=t.topDisplayIndex,this.collection.bottomDisplayIndex=t.bottomDisplayIndex,"function"==typeof(e=this.collection).trigger?e.trigger("viewStatsChanged"):void 0)},t.prototype._initializeCollection=function(){return this.data instanceof i.Collection&&(this.collection||(this.collection=this.data)),null!=this.collection?(this.collection.on("reset",this._onCollectionReset),this.collection.on("add",this._onCollectionAdd)):void 0},t.prototype._renderGrid=function(){return this.$tilegrid&&this.$tilegrid.length>0?this.$tilegrid:(this.$tilegrid=this.$tilegridTemplate.clone(),this.$element.html(this.$tilegrid),this.$loadingIndicator=this.$element.find(".tilegrid-loading"),this.options.ignoreViewport||(this._debouncedOnScroll=n.debounce(this._onScroll,100),this._debouncedOnResize=n.debounce(this._onResize,100),this.$tilegrid.on("scroll",this._debouncedOnScroll),this.$tilegrid.on("resize",this._debouncedOnResize)),this.$tilegrid.on("click",this._onTilegridClick),this.$tilegrid)},t.prototype._renderViewport=function(){return null==this.collection?void this._endOfData():this._loadingInWindow()?this._renderNextPage({success:function(t){return function(){return n.defer(t._renderViewport)}}(this)}):this._ensureViewport()},t.prototype._ensureViewport=function(){var t,e,i;if(!this.options.ignoreViewport&&(i=this.getViewingStats(),e=i.topDisplayIndex,t=i.bottomDisplayIndex,null!=e&&null!=t))return this.updateCollectionViewStats({topDisplayIndex:e+1,bottomDisplayIndex:t+1}),this.topRenderIndex=Math.max(e-this.options.pageSize,0),this.bottomRenderIndex=(t||0)+this.options.pageSize,null!=this.collection&&n.isFunction(this.collection.ensureRows)?this.collection.ensureRows(this.topRenderIndex,this.bottomRenderIndex,{complete:this._onEnsureRowsComplete}):this._onEnsureRowsComplete()},t.prototype._onEnsureRowsComplete=function(){var t,e,i,o;for(e=this.findTileAt(this.topRenderIndex),i=this.topRenderIndex;;){if(!(e&&e.length>0))break;if(null!=i&&(o=this.getItemData(i)),t=e.next(".tile"),null!=o?this.renderTile(e,o):e.remove(),e=t,(i+=1)>this.bottomRenderIndex)break}return this._derenderOutsideTiles(this.topRenderIndex,this.bottomRenderIndex)},t.prototype.getItemData=function(t){var e,i;return(null!=(e=this.collection)&&"function"==typeof e.getItem?e.getItem(t,{warn:!0}):void 0)||(null!=(i=this.collection)?i.models[t]:void 0)||this.data[t]},t.prototype.getViewingStats=function(){var t,e,i,o,n,s;if(s=this._getGridScrollDims(),n=this._findTileInViewport(s),o=t=n,!((null!=n?n.length:void 0)>0))return{topDisplayIndex:0,bottomDisplayIndex:0};for(;;){if(i=o.prev(".tile"),i.length<=0||!this._isInViewPort(this._getTileDims(i),s))break;o=i}for(;;){if(e=t.next(".tile"),e.length<=0||!this._isInViewPort(this._getTileDims(e),s))break;t=e}return{topDisplayIndex:o.data("index"),bottomDisplayIndex:t.data("index")}},t.prototype._getGridScrollDims=function(){var t,e,i,o,n;return e=this.$tilegrid.offset(),i=this.$tilegrid.scrollTop(),t=this.$tilegrid.scrollLeft(),o=this.$tilegrid.height(),n=this.$tilegrid.width(),{top:i+e.top,left:t+e.left,bottom:i+e.top+o,right:t+e.left+n,height:o,width:n,gridOffsetTop:e.top,gridOffsetLeft:e.left}},t.prototype._getTileDims=function(t){var e;return e=t.offset(),n.extend(e,{bottom:e.top+t.height(),right:e.left+t.width()}),e},t.prototype._findTileInViewport=function(t){var e,i,o,n,s,l,r;for(null==t&&(t=this._getGridScrollDims()),i=this.$tilegrid.find(".tile"),e=null,n=Math.floor(i.length/2),s=0;(o=Math.abs(n))>=2&&(l=Math.min(Math.max(0,s+n),i.length-1),e=$(i[l]),!(e.length<=0))&&(r=this._getTileDims(e),!this._isInViewPort(r,t));)n=Math.floor(o/2),(r.left>t.gridOffsetLeft+t.width||r.top>t.gridOffsetTop+t.height)&&(n*=-1),s=l;return e},t.prototype._isInViewPort=function(t,e){var i,o;return null==e&&(e=this._getGridScrollDims()),i=t.right>e.gridOffsetLeft&&t.left<e.gridOffsetLeft+e.width,o=t.bottom>e.gridOffsetTop&&t.top<e.gridOffsetTop+e.height,i&&o},t.prototype.renderAllTiles=function(t){var e,i,o,n,s,l;for(null==t&&(t={}),this.lastAppendedIndex=-1,s=(null!=(n=this.collection)?n.models:void 0)||this.data,l=[],e=0,i=s.length;i>e;e++)o=s[e],l.push(this.appendTile());return l},t.prototype._renderNextPage=function(t){var e,i;return null==t&&(t={}),e=this.lastAppendedIndex+1,i=e+this.options.pageSize,this.lastFirst=e,null!=this.collection&&n.isFunction(this.collection.ensureRows)?this.collection.ensureRows(e,i,{complete:this._onEnsureComplete}):this._onEnsureComplete(e,i)},t.prototype._onEnsureComplete=function(t,e,i){var o,n,s,l,r;if(null==i&&(i={}),e>this.lastAppendedIndex)for(s=n=l=this.lastAppendedIndex+1,r=e;(r>=l?r>n:n>r)&&(o=!this.appendTile(),!(s>=this.getTotalItems()||o));s=r>=l?++n:--n);return s>=this.getTotalItems()&&this._endOfData(),"function"==typeof i.success?i.success():void 0},t.prototype.getTotalItems=function(){var t,e;return null==this.collection?0:(null!=(t=this.collection)&&"function"==typeof t.getLength?t.getLength():void 0)||(null!=(e=this.collection)?e.length:void 0)||this.data.length},t.prototype.appendTile=function(){var t,e,i;return e=this.lastAppendedIndex+1,i=this.getItemData(e),null==i?!1:(this.lastAppendedIndex=e,t=this._cloneTileTemplate(i,this.options),t.attr("data-index",this.lastAppendedIndex),this.$loadingIndicator.before(t),this.renderTile(t,i),!0)},t.prototype._cloneTileTemplate=function(t,e){return null==e&&(e={}),this.$tileTemplate.clone()},t.prototype.renderTileAt=function(t){var e,i;return e=this.tileAt(t),i=this.getItemData(t),e&&i?this.renderTile(e,i):void 0},t.prototype.renderTile=function(t,e){return t.addClass("rendered"),this._$tilesByModelId[e.id]=t,e.on("remove",this._onModelRemove),this._renderTileTemplate(t,e),t.removeAttr("style"),t.toggleClass("selected",e.selected===!0),t.attr("data-id",e.id),t.hasClass("underscore-tile")&&(this.underscroreTemplate||(this.underscroreTemplate=n.template(this.tileTemplate)),t.html(this.underscroreTemplate(e.attributes))),this.options.hideFunction&&this.options.hideFunction(e)&&t.addClass("hidden"),this.trigger("tileRendered",t,e)},t.prototype._renderTileTemplate=function(t,e){return t.html(this._getTileTemplate(t,e))},t.prototype._getTileTemplate=function(t,e){return this.$tileTemplate.html()},t.prototype.tileAt=function(t){return this._$tilesByModelId[this.getItemData(t).id]},t.prototype.findTileAt=function(t){return this.$tilegrid.find("> .tile[data-index='"+t+"']")},t.prototype.tileFor=function(t){var e;return e=t.id||t,this._$tilesByModelId[e]},t.prototype._endOfData=function(t){return null==t&&(t={}),this.$loadingIndicator.hide()},t.prototype._loadingInWindow=function(){var t,e,i,o,n,s,l,r,h,c,d;return this.$element.is(":visible")&&this.$loadingIndicator.is(":visible")?(o=this.$element.outerHeight(),n=this.$element.outerWidth(),o>5e3?(console.error("dev error: the outer height of the .tilegrid element for "+this.selector+" is saying it's outer height is greater that 5000.  You need to set the height to something other than auto. "),l=5e3):l=o,d=n>5e3?5e3:n,c=this.$element.scrollTop(),r=this.$element.scrollLeft(),s=c+l,h=r+d,i=this.$loadingIndicator.position().top,e=this.$loadingIndicator.position().left,t=i<s+this.options.preloadCushion&&e<h+this.options.preloadCushion):!1},t.prototype._onCollectionReset=function(){return this.reset(),this.render()},t.prototype._onCollectionAdd=function(){return this.debouncedRender()},t.prototype._onModelRemove=function(t){var e;return t.off("remove",this._onModelRemove),e=this._$tilesByModelId[t.id],this._derenderTile(e)},t.prototype._onScroll=function(){return this._renderViewport()},t.prototype._onResize=function(){return this._renderViewport()},t.prototype._onTileGridClick=function(t){return t.preventDefault()},t.prototype._derenderOutsideTiles=function(t,e){var i,o,n,s,l,r,h,c,d,p;for(r=e-t,h=this.$element.find(".tile.rendered"),c=[],n=0,l=h.length;l>n;n++)d=h[n],i=$(d),s=i.data("index"),p=t,o=e,s>=p&&o>=s||c.push(this._derenderTile(i));return c},t.prototype._derenderTile=function(t){var e,i;if(t&&t.length>0&&(t.css({height:t.height(),width:t.width()}),this._renderDerenderedPlaceholder(t),t.removeClass("rendered"),t.removeClass("selected"),e=t.data("id"),null!=e))return t.removeAttr("data-id",null),delete this._$tilesByModelId[e],i=t.data("zform"),null!=i?i.destroy():void 0},t.prototype._renderDerenderedPlaceholder=function(t){return t.html("<div class='placeholder'>. . .</div>")},t}()},function(e,exports){e.exports=t},function(t,exports){t.exports=e},function(t,exports){t.exports=i},function(t,exports,e){var i,o,n,s,l,r,h=function(t,e){function i(){this.constructor=t}for(var o in e)c.call(e,o)&&(t[o]=e[o]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;o=e(7),n=e(8),r=e(9),s=e(12),i=e(15),t.exports=l=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.displayName="Tilegrid",e.propTypes={collection:o.PropTypes.any,tileTemplate:o.PropTypes.node,tilegridClass:o.PropTypes.func,tilegridOptions:o.PropTypes.object,tilegridSelectionClass:o.PropTypes.func,tilegridSelectOptions:o.PropTypes.object,children:o.PropTypes.oneOfType([o.PropTypes.arrayOf(o.PropTypes.node),o.PropTypes.node,o.PropTypes.func])},e.defaultProps={tilegridClass:r,tileTemplate:null,tilegridOptions:{},tilegridSelectionClass:s},e.contextTypes={collection:o.PropTypes.any},e.prototype.render=function(){return o.createElement("div",{className:"tilegrid-react"})},e.prototype.componentDidMount=function(){return this.node=n.findDOMNode(this),this.collection=this.props.collection||this.context.collection,this.tileTemplate=this._getTileTemplate(),this.tilegrid=new this.props.tilegridClass(this.node,this.collection,this.tileTemplate,this.props.tilegridOptions),null!=this.props.tilegridSelectionClass?new this.props.tilegridSelectionClass(this.tilegrid,this.props.tilegridSelectOptions):void 0},e.prototype.componentWillUnmount=function(){return o.unmountComponentAtNode(this.node),this.tilegrid.destroy()},e.prototype.componentWillReceiveProps=function(){},e.prototype._getTileTemplate=function(){return this.props.tileTemplate||this._findTileChild()},e.prototype._findTileChild=function(){return this.props.children},e}(o.Component)},function(t,exports){t.exports=o},function(t,exports){t.exports=n},function(t,exports,e){var $,i,o,n,s,l,r,h=function(t,e){return function(){return t.apply(e,arguments)}},c=function(t,e){function i(){this.constructor=t}for(var o in e)d.call(e,o)&&(t[o]=e[o]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},d={}.hasOwnProperty;o=e(7),n=e(8),$=r=e(4),s=e(2),i=e(10),t.exports=l=function(t){function e(){return this._cloneTileTemplate=h(this._cloneTileTemplate,this),this._getTileTemplate=h(this._getTileTemplate,this),this._renderDerenderedPlaceholder=h(this._renderDerenderedPlaceholder,this),this._renderTileTemplate=h(this._renderTileTemplate,this),this.isReactTemplate=h(this.isReactTemplate,this),this.setTileTemplate=h(this.setTileTemplate,this),e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.setTileTemplate=function(t){return this.isReactTemplate(t)?this.$tileTemplate=t:e.__super__.setTileTemplate.apply(this,arguments)},e.prototype.isReactTemplate=function(t){return null==t&&(t=this._getTileTemplate()),_.isArray(t)&&(t=t[0]),3===_.intersection(["props","type","key"],_.keys(t)).length||t.prototype instanceof o.Component},e.prototype._renderTileTemplate=function(t,s){var l,r,h;return r=parseInt(t.attr("data-index")),_.isNaN(r)&&(r=0),h=this._getTileTemplate(t,s),_.isFunction(h)&&(h=h(s,r)),this.isReactTemplate(h)?(l=o.createElement(i,{model:s},h),n.render(l,t[0])):e.__super__._renderTileTemplate.apply(this,arguments)},e.prototype._renderDerenderedPlaceholder=function(t){var i;return i=this._getTileTemplate(),(this.isReactTemplate(i)||_.isFunction(i))&&n.unmountComponentAtNode(t[0]),e.__super__._renderDerenderedPlaceholder.apply(this,arguments)},e.prototype._getTileTemplate=function(t,e){return this.tileTemplate},e.prototype._cloneTileTemplate=function(t,i){var o,n;return null==i&&(i={}),n=this._getTileTemplate(),this.isReactTemplate(n)||_.isFunction(n)?(o=null!=i.tileWrapperClassNames&&"function"==typeof i.tileWrapperClassNames?i.tileWrapperClassNames(t):"",$("<div class='tile "+o+"'></div>")):e.__super__._cloneTileTemplate.apply(this,arguments)},e}(s)},function(t,exports,e){var i,o,n,s,l,r=function(t,e){function i(){this.constructor=t}for(var o in e)h.call(e,o)&&(t[o]=e[o]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},h={}.hasOwnProperty;s=e(7),i=e(5),l=e(3),o=e(11),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return r(e,t),e.displayName="react-datum.Model",e.prototype.dataType=i.Model,e.prototype.contextKey="model",e.modelPropType=s.PropTypes.oneOfType([s.PropTypes.instanceOf(i.Model),s.PropTypes.object]),e.propTypes=l.extend({},o.propTypes,{model:e.modelPropType.isRequired}),e.childContextTypes=l.extend({},o.childContextTypes,{model:e.modelPropType}),e.prototype.update=function(){return e.__super__.update.apply(this,arguments)},e}(o)},function(t,exports,e){var i,o,n,s,l=function(t,e){return function(){return t.apply(e,arguments)}},r=function(t,e){function i(){this.constructor=t}for(var o in e)h.call(e,o)&&(t[o]=e[o]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},h={}.hasOwnProperty;n=e(7),i=e(5),s=e(3),t.exports=o=function(t){function e(t){this.update=l(this.update,this),this.onDataChanged=l(this.onDataChanged,this),e.__super__.constructor.call(this,t),this.state={lastUpdated:null,collectionOrModel:null},this.debouncedUpdate=this.props.debouncedUpdate?s.debounce(this.update,this.props.debounceMs):this.update}return r(e,t),e.prototype.dataType=null,e.prototype.contextKey=null,e.propTypes={fetch:n.PropTypes.bool,fetchOptions:n.PropTypes.object,placeholder:n.PropTypes.node,className:n.PropTypes.string,debouncedUpdate:n.PropTypes.bool,debounceMs:n.PropTypes.number,debug:n.PropTypes.bool,style:n.PropTypes.object},e.childContextTypes={},e.defaultProps={fetch:!1,fetchOptions:{},placeholder:void 0,style:{},debouncedUpdate:!0,debounceMs:0},e.prototype.getChildContext=function(){var t;return t={},t[this.contextKey]=this.state.collectionOrModel,t},e.prototype.render=function(){var t;return t="contextual-data "+this.contextKey,null!=this.props.className&&(t+=" "+this.props.className),n.createElement("span",{style:s.extend({},this.props.style),className:t},this.renderContent())},e.prototype.renderContent=function(){return null!=this.state.collectionOrModel||void 0===this.props.placeholder?this.props.children:this.props.placeholder},e.prototype.componentWillUnmount=function(){return this.unbindEvents()},e.prototype.componentWillMount=function(){return this.initializeCollectionOrModel()},e.prototype.componentWillReceiveProps=function(t){return this.props=t,this.initializeCollectionOrModel()},e.prototype.fetchCollectionOrModel=function(){return this.state.collectionOrModel.fetch(this.props.fetchOptions)},e.prototype.initializeCollectionOrModel=function(){return this.needsReinitializing()?(this.unbindEvents(),this.setCollectionOrModel(),this.bindEvents(),this.props.fetch&&null!=this.state.collectionOrModel?this.fetchCollectionOrModel():void 0):void 0},e.prototype.getInputCollectionOrModel=function(){return this.props[this.contextKey]||this.context[this.contextKey]},e.prototype.getCollectionOrModelToProvide=function(){return this.getInputCollectionOrModel()},e.prototype.needsReinitializing=function(){var t,e;return t=this.getCollectionOrModelToProvide(),e=null==this.state.collectionOrModel||t!==this._lastPropsModel,this._lastPropsModel=t,e},e.prototype.setCollectionOrModel=function(){var t;return t=this.getCollectionOrModelToProvide(),this.setState({collectionOrModel:t}),this.state.collectionOrModel=t},e.prototype.bindEvents=function(){var t;return null!=(t=this.state.collectionOrModel)&&"function"==typeof t.on?t.on("all",this.onDataChanged,this):void 0},e.prototype.unbindEvents=function(){var t;return null!=(t=this.state.collectionOrModel)&&"function"==typeof t.off?t.off("all",this.onDataChanged):void 0},e.prototype.onDataChanged=function(){return this.debouncedUpdate()},e.prototype.update=function(){return this.props.debug&&console.log("ContextualData: update on model",this.state.collectionOrModel),this.setState({lastUpdated:Date.now(),collectionOrModel:this.getCollectionOrModelToProvide()}),this.props.forceUpdate?this.forceUpdate():void 0},e}(n.Component)},function(t,exports,e){var $,i,o,n,s,l=function(t,e){return function(){return t.apply(e,arguments)}};n=e(3),$=s=e(4),i=e(13),e(14),t.exports=o=function(){function t(t,e){this.tilegrid=t,null==e&&(e={}),this._scrollIntoView=l(this._scrollIntoView,this),this._getTileFromEvent=l(this._getTileFromEvent,this),this._getIndexFromEvent=l(this._getIndexFromEvent,this),this._getSameTileOnRelativeRow=l(this._getSameTileOnRelativeRow,this),this._getSameIndexOnRelativeRow=l(this._getSameIndexOnRelativeRow,this),this._onRightArrow=l(this._onRightArrow,this),this._onLeftArrow=l(this._onLeftArrow,this),this._onPageUp=l(this._onPageUp,this),this._onPageDown=l(this._onPageDown,this),this._onUpArrow=l(this._onUpArrow,this),this._onDownArrow=l(this._onDownArrow,this),this._onKeydown=l(this._onKeydown,this),this._getKeymap=l(this._getKeymap,this),this._onSelectAll=l(this._onSelectAll,this),this._onSelectionsChanged=l(this._onSelectionsChanged,this),this._onTileMouseUp=l(this._onTileMouseUp,this),this._onTileMouseDown=l(this._onTileMouseDown,this),this._onFocusSinkFocus=l(this._onFocusSinkFocus,this),this._initializeKeyboard=l(this._initializeKeyboard,this),this._initializeCollection=l(this._initializeCollection,this),this._initializeTilegrid=l(this._initializeTilegrid,this),this.focus=l(this.focus,this),this.getNextTile=l(this.getNextTile,this),this.getPreviousTile=l(this.getPreviousTile,this),this.updateTileStates=l(this.updateTileStates,this),this.setActiveTile=l(this.setActiveTile,this),this.getActiveTile=l(this.getActiveTile,this),this.resetActiveTile=l(this.resetActiveTile,this),this.selectNone=l(this.selectNone,this),this.selectToggle=l(this.selectToggle,this),this.selectOnlyOne=l(this.selectOnlyOne,this),this.selectOne=l(this.selectOne,this),this.initialize=l(this.initialize,this),this.options=n.defaults(e,{selectOneOnSelected:!0,scrollElement:this.tilegrid.$element,scrollOptions:{duration:0,cushion:{top:40,bottom:40}}}),this.collection=this.tilegrid.collection,this.collection.hasSelectableCollectionMixin||i.applyTo(this.collection),this.initialize()}return t.prototype.initialize=function(){return this._initializeTilegrid(),this._initializeCollection(),this._initializeKeyboard(),this},t.prototype.selectOne=function(t,e,i){return null==e&&(e=!0),null==i&&(i={}),i=n.defaults(i,{silent:!1,active:!0}),e===!0&&i.active?this.setActiveTile(t):this.collection.selectModelByIndex(t,e,i)},t.prototype.selectOnlyOne=function(t){return null!=t&&t>=0?(this.selectNone(),this.selectOne(t)):void 0},t.prototype.selectToggle=function(t){return this.selectOne(t,"toggle")},t.prototype.selectNone=function(){return this.collection.selectNone(),this.resetActiveTile()},t.prototype.resetActiveTile=function(){return this.setActiveTile(null)},t.prototype.getActiveTile=function(){return this.tilegrid.$element.find(".tile.active")},t.prototype.setActiveTile=function(t){var e,i;return i=this.getActiveTile(),e=null,null!=t&&(e=this.tilegrid.findTileAt(t),e&&e.length>0&&!e.is(i)&&this._scrollIntoView(e,e.closest(":hasScroll"),this.options.scrollOptions)),(i&&!e||!i&&e||!(null!=e?e.is(i):void 0))&&(this.collection.setActiveIndex(t),null!=t&&this.collection.selectModelByIndex(t),this.tilegrid.trigger("activeTileChanged",e,i)),this.updateTileStates(i),this.updateTileStates(e),e},t.prototype.updateTileStates=function(t){var e;if(null!=t&&(e=this.collection.get(t.attr("data-id")),null!=e))return t.toggleClass("selected",e.selected),t.toggleClass("active",e.active)},t.prototype.getPreviousTile=function(){return this.getActiveTile().prevAll(".tile:visible").first()},t.prototype.getNextTile=function(){return this.getActiveTile().nextAll(".tile:visible").first()},t.prototype.focus=function(){return this.$focusSink.focus()},t.prototype._initializeTilegrid=function(){return this.tilegrid.$element.on("mousedown.SingleSelect",".tile",this._onTileMouseDown),this.tilegrid.$element.on("mouseup.SingleSelect",".tile",this._onTileMouseUp),this.tilegrid.selections=this},t.prototype._initializeCollection=function(){return this.collection.on("selectionsChanged",this._onSelectionsChanged),this.collection.on("selectAll",this._onSelectAll)},t.prototype._initializeKeyboard=function(){return this.tilegrid.$element.on("click",this.focus),this.$focusSink=$('<input class="tilegrid-focus-sink" type="text">'),this.tilegrid.$element.prepend(this.$focusSink),this.$focusSink.on("keydown",this._onKeydown),this.$focusSink.on("focus",this._onFocusSinkFocus)},t.prototype._onFocusSinkFocus=function(){},t.prototype._onTileMouseDown=function(t){var e,i;return t.preventDefault(),$(t.target).closest(".tile").hasClass("no-select")?void 0:(e=this._getIndexFromEvent(t),this.options.selectOneOnSelected?(null!=(i=this.tilegrid.tileAt(e))?i.hasClass("active"):void 0)?void 0:this.selectOnlyOne(e):(this.setActiveTile(e),this.collection.trigger("selectedClicked",e,t)))},t.prototype._onTileMouseUp=function(t){},t.prototype._onSelectionsChanged=function(){var t,e,i,o,n,s,l;if(l=this.collection.getSelectedModels(),this.tilegrid.$element.find(">.tilegrid>.tile.selected").removeClass("selected"),l.length<=0)return this.resetActiveTile();for(s=[],e=0,i=l.length;i>e;e++)o=l[e],n=null!=o.index?o.index:this.collection.indexOf(o),t=this.tilegrid.$element.find(">.tilegrid>.tile[data-index='"+n+"']"),t.addClass("selected"),s.push(t.toggleClass("active",o.active));return s},t.prototype._onSelectAll=function(){return this.setActiveTile(0)},t.prototype._getKeymap=function(){return{40:this._onDownArrow,38:this._onUpArrow,33:this._onPageUp,34:this._onPageDown,37:this._onLeftArrow,39:this._onRightArrow}},t.prototype._onKeydown=function(t){var e,i;return"function"==typeof(e=this._getKeymap())[i=t.keyCode]?e[i](t):void 0},t.prototype._onDownArrow=function(t){return this.selectOnlyOne(this._getSameIndexOnRelativeRow(1))},t.prototype._onUpArrow=function(t){return this.selectOnlyOne(this._getSameIndexOnRelativeRow(-1))},t.prototype._onPageDown=function(t){return this.selectOnlyOne(this._getSameIndexOnRelativeRow(5))},t.prototype._onPageUp=function(t){return this.selectOnlyOne(this._getSameIndexOnRelativeRow(-5))},t.prototype._onLeftArrow=function(t){return this.selectOnlyOne(this.getPreviousTile().data("index"))},t.prototype._onRightArrow=function(t){return this.selectOnlyOne(this.getNextTile().data("index"))},t.prototype._getSameIndexOnRelativeRow=function(t){var e;return null!=(e=this._getSameTileOnRelativeRow(t))?e.data("index"):void 0},t.prototype._getSameTileOnRelativeRow=function(t){var e,i,o,n,s,l,r,h,c,d,p,u,a,f,g,_;if(e=this.tilegrid.$element.find(".tile.active"),0===t)return e;for(o=e,_=Math.abs(t);;){if(i=t>0?o.nextAll(".tile:visible").first():o.prevAll(".tile:visible").first(),i.length<=0)break;if(p=i.height(),g=i.width(),f=i.position().top,d=f+p,u=i.position().left,a=u+g,s=e.height(),c=e.width(),h=e.position().top,n=h+s,l=e.position().left,r=l+c,(t>0&&f>n&&(u>=l||a>=r)||0>t&&h>f&&(l>=u||r>=a))&&(e=i,_-=1),o=i,0>=_)break}return o},t.prototype._getIndexFromEvent=function(t){var e,i;if(e=this._getTileFromEvent(t),!e)return-1;if(i=e.data("index"),null==i)throw"dev: error: invalid tile found in tilegrid, no data-index attribute";return i},t.prototype._getTileFromEvent=function(t){var e,i;return e=$(t.target),i=e.closest(".tile"),i.length<=0?(console.warn("dev: error: _getIndexFromEvent unable to find .tile for "+e.selector),null):i},t.prototype._scrollIntoView=function(t,e,i){var o,s,l,r,h,c,d,p,u,a,f,g,_,y;return null==i&&(i={}),i=n.defaults(i,{cushion:{},duration:100,alwaysAtTop:!1,top:null,left:null,height:null,width:null}),!((null!=e?e.length:void 0)>0)||e.is($(document))||(i.cushion=n.defaults(i.cushion,{left:10,right:10,top:10,bottom:15}),l=i.top||t.position().top,s=i.left||t.position().left,o=i.height||t.outerHeight(),r=i.width||t.outerWidth(),g=e.scrollTop(),_=i.parentTop||g,f=e.scrollLeft(),a=e.outerHeight(),y=e.outerWidth(),c=l-i.cushion.top<0,d=l+o+i.cushion.bottom>a,p=s-i.cushion.left<0,u=s+r+i.cushion.right>y,h={},c||i.alwaysAtTop?h.scrollTop=Math.max(_+l-i.cushion.top,0):d&&(h.scrollTop=g+l+o+i.cushion.bottom-a),p?h.scrollLeft=f+s-i.cushion.left:u&&(h.scrollLeft=s+r+i.cushion.right-y),n.keys(h).length<=0)?void 0:(i.duration>0?e.animate(h,i.duration,"linear"):(null!=h.scrollTop&&e.scrollTop(h.scrollTop),null!=h.scrollLeft&&e.scrollLeft(h.scrollLeft)),t)},t}()},function(t,exports,e){var i,o,n=function(t,e){return function(){return t.apply(e,arguments)}};o=e(3),t.exports=i=function(){function t(){this.setActiveModelById=n(this.setActiveModelById,this),this.setActiveIndex=n(this.setActiveIndex,this),this.getActiveModel=n(this.getActiveModel,this),this.setActiveModel=n(this.setActiveModel,this),this.selectNone=n(this.selectNone,this),this.selectAll=n(this.selectAll,this),this.selectModelByIndex=n(this.selectModelByIndex,this),this.selectModelById=n(this.selectModelById,this),this.selectModel=n(this.selectModel,this)}return t.applyTo=function(t){return t.hasSelectableCollectionMixin?void 0:(t.hasSelectableCollection=!0,this.warnIfReplacingMethods(t),o.extend(t,this.prototype))},t.warnIfReplacingMethods=function(t){var e;return e=o.intersection(o.keys(t),o.keys(this.prototype)),e.length>0?console.error("Warning: using SelectableCollection mixin will replace the following methods: "+e.join(", ")):void 0;
},t.prototype.hasSelectableCollectionMixin=!0,t.prototype.getSelectedModels=function(){return o.filter(this.models,function(t){return t.selected})},t.prototype.selectModel=function(t,e,i){return null==e&&(e=!0),null==i&&(i={}),i=o.defaults(i,{silent:!1}),null==t?(console.warn("SelectableCollection: selectModel called on null model"),!1):("toggle"===e?t.selected=null==t.selected||t.selected===!1:t.selected=e,i.silent||this.trigger("selectionsChanged"),t.selected)},t.prototype.selectModelById=function(t,e,i){return null==e&&(e=!0),null==i&&(i={}),this.selectModel(this.get(t),e,i)},t.prototype.selectModelByIndex=function(t,e,i){return null==e&&(e=!0),null==i&&(i={}),this.selectModel(this.models[t],e,i)},t.prototype.selectAll=function(t){var e,i,n,s;for(null==t&&(t={}),t=o.defaults(t,{silent:!1}),s=this.models,e=0,i=s.length;i>e;e++)n=s[e],null!=n&&this.selectModel(n,!0,{silent:!0});return t.silent?void 0:this.trigger("selectionsChanged")},t.prototype.selectNone=function(t){var e,i,n,s;for(null==t&&(t={}),t=o.defaults(t,{silent:!1}),s=this.getSelectedModels(),e=0,i=s.length;i>e;e++)n=s[e],null!=n&&this.selectModel(n,!1,{silent:!0});return t.silent||this.trigger("selectionsChanged"),this.setActiveModel(null)},t.prototype.setActiveModel=function(t,e){var i;return null==e&&(e={}),e=o.defaults(e,{active:!0,silent:!1}),i=this.getActiveModel(),null!=i&&(i.active=!1),this.selectModel(t,e),null!=t&&(t.active=e.active),this.activeModel=t,e.silent?void 0:this.trigger("activeModelChanged",t)},t.prototype.getActiveModel=function(){return this.activeModel},t.prototype.setActiveIndex=function(t,e){return null==e&&(e={}),this.setActiveModel(this.models[t])},t.prototype.setActiveModelById=function(t,e){return null==e&&(e={}),this.setActiveModel(this.get(t),e)},t}()},function(t,exports,e){var $,i;$=e(4),i=function(t,e,i){var o,n,s,l,r,h,c;if(o=$(t),l=o.css("overflow-x"),r=o.css("overflow-y"),s="hidden",c="visible",h="scroll",n=i[3]){if("x"===n){if(l===s||l===c)return!1;if(l===h)return!0}else if("y"===n){if(r===s||r===c)return!1;if(r===h)return!0}}else{if(l===r&&(r===s||r===c))return!1;if(l===h||r===h)return!0}return o.innerHeight()<t.scrollHeight||o.innerWidth()<t.scrollWidth},$.expr[":"].hasScroll=i},function(t,exports,e){var $,i,o,n,s,l=function(t,e){return function(){return t.apply(e,arguments)}},r=function(t,e){function i(){this.constructor=t}for(var o in e)h.call(e,o)&&(t[o]=e[o]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},h={}.hasOwnProperty;$=s=e(4),n=e(3),o=e(12),t.exports=i=function(t){function e(){this._whichMethod=l(this._whichMethod,this),this._onRightArrow=l(this._onRightArrow,this),this._onLeftArrow=l(this._onLeftArrow,this),this._onPageUp=l(this._onPageUp,this),this._onPageDown=l(this._onPageDown,this),this._onUpArrow=l(this._onUpArrow,this),this._onDownArrow=l(this._onDownArrow,this),this._onTileMouseMove=l(this._onTileMouseMove,this),this._onTileMouseDown=l(this._onTileMouseDown,this),this.selectExtend=l(this.selectExtend,this),this._initializeDragSelect=l(this._initializeDragSelect,this),this.initialize=l(this.initialize,this),e.__super__.constructor.apply(this,arguments)}return r(e,t),e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this._initializeDragSelect()},e.prototype._initializeDragSelect=function(){return this.mouseDown=!1,$(document).on("mousedown",function(t){return function(){return t.mouseDown=!0}}(this)),$(document).on("mouseup",function(t){return function(){return t.mouseDown=!1}}(this)),this.tilegrid.$element.on("mousemove.multiSelect",".tile",this._onTileMouseMove)},e.prototype.selectExtend=function(t){var e,i,o,s,l,r,h;return e=this.getActiveTile(),o=e.data("index"),i=e,r=function(e){return function(){for(var n,s;;){if(n=null,i=i=o>t?i.prev():i.next(),s=i.data("index"),null==s)break;if(n=s,e.selectOne(s,!0,{silent:!0,active:!1}),s===t)break}return e.collection.trigger("selectionsChanged"),e.setActiveTile(n)}}(this),h=this.tilegrid.getViewingStats(),s=o>t?h.topDisplayIndex:o,l=t>o?h.bottomDisplayIndex:t,n.isFunction(this.collection.ensureRows)?this.collection.ensureRows(s,l,{complete:r}):r(),this.collection.trigger("selectionsChanged")},e.prototype._onTileMouseDown=function(t){var i,o,n;return t.preventDefault(),!$(t.target).closest(".tile").hasClass("no-select")&&(n=this._whichMethod(t),i=$(t.target).closest(".tile"),o=this._getIndexFromEvent(t),this.lastMouseDownIndex=o,this.lastToggleIndex=null,(null!=i?i.length:void 0)>0)?n===this.selectOnlyOne&&!this.options.selectOneOnSelected&&i.hasClass("selected")?e.__super__._onTileMouseDown.apply(this,arguments):n===this.selectOne&&i.hasClass("selected")?(this.selectOne(o,!1,{active:!1}),i.hasClass("active")?this.setActiveTile(null):void 0):n(o):void 0},e.prototype._onTileMouseMove=function(t){var e,i;if(t.preventDefault(),e=$(t.target),this.mouseDown&&!(e.hasClass("active")||e.parents(".tile.active").length>0))if(i=this._getIndexFromEvent(t),t.metaKey||t.ctrlKey){if(i!==this.lastToggleIndex&&i!==this.lastMouseDownIndex)return this.lastToggleIndex=i,this.selectToggle(i)}else if(!(0>i))return this.selectExtend(i)},e.prototype._onDownArrow=function(t){return this._whichMethod(t)(this._getSameIndexOnRelativeRow(1))},e.prototype._onUpArrow=function(t){return this._whichMethod(t)(this._getSameIndexOnRelativeRow(-1))},e.prototype._onPageDown=function(t){return this._whichMethod(t)(this._getSameIndexOnRelativeRow(5))},e.prototype._onPageUp=function(t){return this._whichMethod(t)(this._getSameIndexOnRelativeRow(-5))},e.prototype._onLeftArrow=function(t){return this._whichMethod(t)(this.getPreviousTile().data("index"))},e.prototype._onRightArrow=function(t){return this._whichMethod(t)(this.getNextTile().data("index"))},e.prototype._whichMethod=function(t){return t.shiftKey?this.selectExtend:t.ctrlKey||t.metaKey?this.selectOne:this.selectOnlyOne},e}(o)}])});